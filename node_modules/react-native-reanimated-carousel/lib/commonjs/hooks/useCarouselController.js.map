{"version":3,"sources":["useCarouselController.tsx"],"names":["useCarouselController","options","size","loop","dataLength","handlerOffset","withAnimation","defaultIndex","duration","autoFillData","dataInfo","React","useMemo","length","disable","originalLength","index","sharedIndex","sharedPreIndex","currentFixedPage","useCallback","Math","round","value","fixed","abs","setSharedIndex","newSharedIndex","current","handlerOffsetValue","toInt","isPositive","i","newSharedIndexValue","rawDataLength","convertToSharedIndex","runOnJS","getCurrentIndex","realIndex","canSliding","onScrollEnd","onScrollBegin","scrollWithTiming","toValue","onFinished","callback","isFinished","defaultWithAnimation","type","config","easing","Easing","easeOutQuart","dealWithAnimation","next","opts","count","animated","nextPage","prev","prevPage","to","direction","offset","totalSize","isCloseToNextLoop","finalOffset","floor","scrollTo","n","getSharedIndex"],"mappings":"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","sourcesContent":["import React, { useRef } from \"react\";\nimport type Animated from \"react-native-reanimated\";\nimport {\n  runOnJS,\n  useAnimatedReaction,\n  useSharedValue,\n} from \"react-native-reanimated\";\n\nimport { Easing } from \"../constants\";\nimport type {\n  TCarouselActionOptions,\n  TCarouselProps,\n  WithTimingAnimation,\n} from \"../types\";\nimport { computedRealIndexWithAutoFillData, convertToSharedIndex } from \"../utils/computedWithAutoFillData\";\nimport { dealWithAnimation } from \"../utils/dealWithAnimation\";\nimport { handlerOffsetDirection } from \"../utils/handlerOffsetDirection\";\nimport { round } from \"../utils/log\";\n\ninterface IOpts {\n  loop: boolean\n  size: number\n  dataLength: number\n  autoFillData: TCarouselProps[\"autoFillData\"]\n  handlerOffset: Animated.SharedValue<number>\n  withAnimation?: TCarouselProps[\"withAnimation\"]\n  duration?: number\n  defaultIndex?: number\n  onScrollBegin?: () => void\n  onScrollEnd?: () => void\n}\n\nexport interface ICarouselController {\n  getSharedIndex: () => number\n  prev: (opts?: TCarouselActionOptions) => void\n  next: (opts?: TCarouselActionOptions) => void\n  getCurrentIndex: () => number\n  scrollTo: (opts?: TCarouselActionOptions) => void\n}\n\nexport function useCarouselController(options: IOpts): ICarouselController {\n  const {\n    size,\n    loop,\n    dataLength,\n    handlerOffset,\n    withAnimation,\n    defaultIndex = 0,\n    duration,\n    autoFillData,\n  } = options;\n\n  const dataInfo = React.useMemo(\n    () => ({\n      length: dataLength,\n      disable: !dataLength,\n      originalLength: dataLength,\n    }),\n    [dataLength],\n  );\n\n  const index = useSharedValue<number>(defaultIndex);\n  // The Index displayed to the user\n  const sharedIndex = useRef<number>(defaultIndex);\n  const sharedPreIndex = useRef<number>(defaultIndex);\n\n  const currentFixedPage = React.useCallback(() => {\n    if (loop)\n      return -Math.round(handlerOffset.value / size);\n\n    const fixed = (handlerOffset.value / size) % dataInfo.length;\n    return Math.round(\n      handlerOffset.value <= 0\n        ? Math.abs(fixed)\n        : Math.abs(fixed > 0 ? dataInfo.length - fixed : 0),\n    );\n  }, [handlerOffset, dataInfo, size, loop]);\n\n  function setSharedIndex(newSharedIndex: number) {\n    sharedIndex.current = newSharedIndex;\n  }\n\n  useAnimatedReaction(\n    () => {\n      const handlerOffsetValue = handlerOffset.value;\n      const toInt = round(handlerOffsetValue / size) % dataInfo.length;\n      const isPositive = handlerOffsetValue <= 0;\n      const i = isPositive\n        ? Math.abs(toInt)\n        : Math.abs(toInt > 0 ? dataInfo.length - toInt : 0);\n\n      const newSharedIndexValue = convertToSharedIndex({\n        loop,\n        rawDataLength: dataInfo.originalLength,\n        autoFillData: autoFillData!,\n        index: i,\n      });\n\n      return {\n        i,\n        newSharedIndexValue,\n      };\n    },\n    ({ i, newSharedIndexValue }) => {\n      index.value = i;\n      runOnJS(setSharedIndex)(newSharedIndexValue);\n    },\n    [\n      sharedPreIndex,\n      sharedIndex,\n      size,\n      dataInfo,\n      index,\n      loop,\n      autoFillData,\n      handlerOffset,\n    ],\n  );\n\n  const getCurrentIndex = React.useCallback(() => {\n    const realIndex = computedRealIndexWithAutoFillData({\n      index: index.value,\n      dataLength: dataInfo.originalLength,\n      loop,\n      autoFillData: autoFillData!,\n    });\n\n    return realIndex;\n  }, [index, autoFillData, dataInfo, loop]);\n\n  const canSliding = React.useCallback(() => {\n    return !dataInfo.disable;\n  }, [dataInfo]);\n\n  const onScrollEnd = React.useCallback(() => {\n    options.onScrollEnd?.();\n  }, [options]);\n\n  const onScrollBegin = React.useCallback(() => {\n    options.onScrollBegin?.();\n  }, [options]);\n\n  const scrollWithTiming = React.useCallback(\n    (toValue: number, onFinished?: () => void) => {\n      \"worklet\";\n      const callback = (isFinished: boolean) => {\n        \"worklet\";\n        if (isFinished) {\n          runOnJS(onScrollEnd)();\n          onFinished && runOnJS(onFinished)();\n        }\n      };\n\n      const defaultWithAnimation: WithTimingAnimation = {\n        type: \"timing\",\n        config: { duration, easing: Easing.easeOutQuart },\n      };\n\n      return dealWithAnimation(withAnimation ?? defaultWithAnimation)(\n        toValue,\n        callback,\n      );\n    },\n    [duration, withAnimation, onScrollEnd],\n  );\n\n  const next = React.useCallback(\n    (opts: TCarouselActionOptions = {}) => {\n      \"worklet\";\n      const { count = 1, animated = true, onFinished } = opts;\n      if (!canSliding() || (!loop && index.value >= dataInfo.length - 1))\n        return;\n\n      onScrollBegin?.();\n\n      const nextPage = currentFixedPage() + count;\n      index.value = nextPage;\n\n      if (animated) {\n        handlerOffset.value = scrollWithTiming(\n          -nextPage * size,\n          onFinished,\n        ) as any;\n      }\n      else {\n        handlerOffset.value = -nextPage * size;\n        onFinished?.();\n      }\n    },\n    [\n      canSliding,\n      loop,\n      index,\n      dataInfo,\n      onScrollBegin,\n      handlerOffset,\n      size,\n      scrollWithTiming,\n      currentFixedPage,\n    ],\n  );\n\n  const prev = React.useCallback(\n    (opts: TCarouselActionOptions = {}) => {\n      const { count = 1, animated = true, onFinished } = opts;\n      if (!canSliding() || (!loop && index.value <= 0)) return;\n\n      onScrollBegin?.();\n\n      const prevPage = currentFixedPage() - count;\n      index.value = prevPage;\n\n      if (animated) {\n        handlerOffset.value = scrollWithTiming(\n          -prevPage * size,\n          onFinished,\n        );\n      }\n      else {\n        handlerOffset.value = -prevPage * size;\n        onFinished?.();\n      }\n    },\n    [\n      canSliding,\n      loop,\n      index,\n      onScrollBegin,\n      handlerOffset,\n      size,\n      scrollWithTiming,\n      currentFixedPage,\n    ],\n  );\n\n  const to = React.useCallback(\n    (opts: { i: number; animated: boolean; onFinished?: () => void }) => {\n      const { i, animated = false, onFinished } = opts;\n      if (i === index.value) return;\n      if (!canSliding()) return;\n\n      onScrollBegin?.();\n      // direction -> 1 | -1\n      const direction = handlerOffsetDirection(handlerOffset);\n\n      // target offset\n      const offset = i * size * direction;\n      // page width size * page count\n      const totalSize = dataInfo.length * size;\n\n      let isCloseToNextLoop = false;\n\n      if (loop) {\n        isCloseToNextLoop\n                    = Math.abs(handlerOffset.value % totalSize) / totalSize\n                    >= 0.5;\n      }\n\n      const finalOffset\n                = (Math.floor(Math.abs(handlerOffset.value / totalSize))\n                    + (isCloseToNextLoop ? 1 : 0))\n                    * totalSize\n                    * direction\n                + offset;\n\n      if (animated) {\n        index.value = i;\n        handlerOffset.value = scrollWithTiming(finalOffset, onFinished);\n      }\n      else {\n        handlerOffset.value = finalOffset;\n        index.value = i;\n        onFinished?.();\n      }\n    },\n    [\n      index,\n      canSliding,\n      onScrollBegin,\n      handlerOffset,\n      size,\n      dataInfo.length,\n      loop,\n      scrollWithTiming,\n    ],\n  );\n\n  const scrollTo = React.useCallback(\n    (opts: TCarouselActionOptions = {}) => {\n      const { index: i, count, animated = false, onFinished } = opts;\n      if (typeof i === \"number\" && i > -1) {\n        to({ i, animated, onFinished });\n        return;\n      }\n\n      if (!count)\n        return;\n\n      const n = Math.round(count);\n\n      if (n < 0)\n        prev({ count: Math.abs(n), animated, onFinished });\n\n      else\n        next({ count: n, animated, onFinished });\n    },\n    [prev, next, to],\n  );\n\n  return {\n    next,\n    prev,\n    scrollTo,\n    getCurrentIndex,\n    getSharedIndex: () => sharedIndex.current,\n  };\n}\n"]}
{"version":3,"sources":["createBottomSheetScrollableComponent.tsx"],"names":["React","forwardRef","useImperativeHandle","useMemo","useRef","Platform","useAnimatedProps","useAnimatedStyle","NativeViewGestureHandler","BottomSheetDraggableView","BottomSheetRefreshControl","useScrollHandler","useScrollableSetter","useBottomSheetInternal","GESTURE_SOURCE","SCROLLABLE_DECELERATION_RATE_MAPPER","SCROLLABLE_STATE","styles","createBottomSheetScrollableComponent","type","ScrollableComponent","props","ref","focusHook","scrollEventsHandlersHook","enableFooterMarginAdjustment","overScrollMode","keyboardDismissMode","showsVerticalScrollIndicator","style","refreshing","onRefresh","progressViewOffset","refreshControl","onScroll","onScrollBeginDrag","onScrollEndDrag","rest","nativeGestureRef","refreshControlGestureRef","scrollableRef","scrollableContentOffsetY","scrollHandler","enableContentPanningGesture","animatedFooterHeight","animatedScrollableState","scrollableAnimatedProps","decelerationRate","value","UNLOCKED","containerAnimatedStyle","marginBottom","containerStyle","current","undefined","OS","scrollableContent","SCROLLABLE","container"],"mappings":"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","sourcesContent":["import React, { forwardRef, useImperativeHandle, useMemo, useRef } from 'react';\nimport { Platform } from 'react-native';\nimport { useAnimatedProps, useAnimatedStyle } from 'react-native-reanimated';\nimport { NativeViewGestureHandler } from 'react-native-gesture-handler';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\nimport BottomSheetRefreshControl from '../bottomSheetRefreshControl';\nimport {\n  useScrollHandler,\n  useScrollableSetter,\n  useBottomSheetInternal,\n} from '../../hooks';\nimport {\n  GESTURE_SOURCE,\n  SCROLLABLE_DECELERATION_RATE_MAPPER,\n  SCROLLABLE_STATE,\n  SCROLLABLE_TYPE,\n} from '../../constants';\nimport { styles } from './styles';\n\nexport function createBottomSheetScrollableComponent<T, P>(\n  type: SCROLLABLE_TYPE,\n  ScrollableComponent: any\n) {\n  return forwardRef<T, P>((props, ref) => {\n    // props\n    const {\n      // hooks\n      focusHook,\n      scrollEventsHandlersHook,\n      // props\n      enableFooterMarginAdjustment = false,\n      overScrollMode = 'never',\n      keyboardDismissMode = 'interactive',\n      showsVerticalScrollIndicator = true,\n      style,\n      refreshing,\n      onRefresh,\n      progressViewOffset,\n      refreshControl,\n      // events\n      onScroll,\n      onScrollBeginDrag,\n      onScrollEndDrag,\n      ...rest\n    }: any = props;\n\n    //#region refs\n    const nativeGestureRef = useRef<NativeViewGestureHandler>(null);\n    const refreshControlGestureRef = useRef<NativeViewGestureHandler>(null);\n    //#endregion\n\n    //#region hooks\n    const { scrollableRef, scrollableContentOffsetY, scrollHandler } =\n      useScrollHandler(\n        scrollEventsHandlersHook,\n        onScroll,\n        onScrollBeginDrag,\n        onScrollEndDrag\n      );\n    const {\n      enableContentPanningGesture,\n      animatedFooterHeight,\n      animatedScrollableState,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region variables\n    const scrollableAnimatedProps = useAnimatedProps(\n      () => ({\n        decelerationRate:\n          SCROLLABLE_DECELERATION_RATE_MAPPER[animatedScrollableState.value],\n        showsVerticalScrollIndicator: showsVerticalScrollIndicator\n          ? animatedScrollableState.value === SCROLLABLE_STATE.UNLOCKED\n          : showsVerticalScrollIndicator,\n      }),\n      [showsVerticalScrollIndicator]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        marginBottom: enableFooterMarginAdjustment\n          ? animatedFooterHeight.value\n          : 0,\n      }),\n      [enableFooterMarginAdjustment]\n    );\n    const containerStyle = useMemo(() => {\n      return enableFooterMarginAdjustment\n        ? [\n            ...(style ? ('length' in style ? style : [style]) : []),\n            containerAnimatedStyle,\n          ]\n        : style;\n    }, [enableFooterMarginAdjustment, style, containerAnimatedStyle]);\n    //#endregion\n\n    //#region effects\n    // @ts-ignore\n    useImperativeHandle(ref, () => scrollableRef.current);\n    useScrollableSetter(\n      scrollableRef,\n      type,\n      scrollableContentOffsetY,\n      onRefresh !== undefined,\n      focusHook\n    );\n    //#endregion\n\n    //#region render\n    if (Platform.OS === 'android') {\n      const scrollableContent = (\n        <NativeViewGestureHandler\n          ref={nativeGestureRef}\n          enabled={enableContentPanningGesture}\n          shouldCancelWhenOutside={false}\n        >\n          <ScrollableComponent\n            animatedProps={scrollableAnimatedProps}\n            {...rest}\n            scrollEventThrottle={16}\n            ref={scrollableRef}\n            overScrollMode={overScrollMode}\n            keyboardDismissMode={keyboardDismissMode}\n            onScroll={scrollHandler}\n            style={containerStyle}\n          />\n        </NativeViewGestureHandler>\n      );\n      return (\n        <BottomSheetDraggableView\n          nativeGestureRef={nativeGestureRef}\n          refreshControlGestureRef={refreshControlGestureRef}\n          gestureType={GESTURE_SOURCE.SCROLLABLE}\n          style={styles.container}\n        >\n          {onRefresh ? (\n            <BottomSheetRefreshControl\n              ref={refreshControlGestureRef}\n              refreshing={refreshing}\n              onRefresh={onRefresh}\n              progressViewOffset={progressViewOffset}\n              style={styles.container}\n            >\n              {scrollableContent}\n            </BottomSheetRefreshControl>\n          ) : (\n            scrollableContent\n          )}\n        </BottomSheetDraggableView>\n      );\n    }\n    return (\n      <BottomSheetDraggableView\n        nativeGestureRef={nativeGestureRef}\n        gestureType={GESTURE_SOURCE.SCROLLABLE}\n        style={styles.container}\n      >\n        <NativeViewGestureHandler\n          ref={nativeGestureRef}\n          enabled={enableContentPanningGesture}\n          shouldCancelWhenOutside={false}\n        >\n          <ScrollableComponent\n            animatedProps={scrollableAnimatedProps}\n            {...rest}\n            scrollEventThrottle={16}\n            ref={scrollableRef}\n            overScrollMode={overScrollMode}\n            keyboardDismissMode={keyboardDismissMode}\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            progressViewOffset={progressViewOffset}\n            refreshControl={refreshControl}\n            onScroll={scrollHandler}\n            style={containerStyle}\n          />\n        </NativeViewGestureHandler>\n      </BottomSheetDraggableView>\n    );\n    //#endregion\n  });\n}\n"]}